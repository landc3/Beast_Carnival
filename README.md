# çŒ›å…½æ´¾å¯¹ - Beast Carnival

ä¸€æ¬¾AIé©±åŠ¨çš„äº’åŠ¨æ¸¸æˆDemoï¼ŒåŒ…å«è§’è‰²ç³»ç»Ÿã€AIå¯¹è¯ã€è§£è°œæ¸¸æˆå’Œæ™ºèƒ½ç‹¼äººæ€ã€‚

## é¡¹ç›®ç‰¹è‰²

- ğŸ¯ **AIåŸç”Ÿäº§å“** - æ‰€æœ‰äº¤äº’éƒ½åŸºäºAIé©±åŠ¨
- ğŸ’ **å®Œæ•´åŠŸèƒ½** - è§’è‰²ç³»ç»Ÿã€å¯¹è¯ã€è§£è°œã€ç‹¼äººæ€
- âœ… **æ¨¡å—åŒ–è®¾è®¡** - æ˜“äºæ‰©å±•å’Œç»´æŠ¤
- ğŸ‘¥ **å¤šäººåŒæ­¥** - æ”¯æŒå®æ—¶å¤šäººæ¸¸æˆ

## æŠ€æœ¯æ ˆ

### åç«¯
- Python 3.8+
- FastAPI - Webæ¡†æ¶
- WebSocket - å®æ—¶é€šä¿¡
- Redis - çŠ¶æ€åŒæ­¥
- DashScope (é€šä¹‰åƒé—®) - AIæœåŠ¡

### å‰ç«¯
- Vue 3 - å‰ç«¯æ¡†æ¶
- Vue Router - è·¯ç”±
- Pinia - çŠ¶æ€ç®¡ç†
- Vite - æ„å»ºå·¥å…·

## é¡¹ç›®ç»“æ„

```
Beast Carnival/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ main.py             # FastAPIä¸»åº”ç”¨
â”‚   â”œâ”€â”€ config.py           # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ character.py
â”‚   â”‚   â”œâ”€â”€ game.py
â”‚   â”‚   â””â”€â”€ event.py
â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ai_service.py
â”‚   â”‚   â”œâ”€â”€ redis_service.py
â”‚   â”‚   â”œâ”€â”€ character_service.py
â”‚   â”‚   â”œâ”€â”€ event_service.py
â”‚   â”‚   â””â”€â”€ werewolf_service.py
â”‚   â”œâ”€â”€ data/               # æ•°æ®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ characters.json
â”‚   â”‚   â””â”€â”€ events.json
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ frontend/               # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/          # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ WorldView.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Characters.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterChat.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Events.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ EventDetail.vue
â”‚   â”‚   â”‚   â””â”€â”€ Werewolf.vue
â”‚   â”‚   â”œâ”€â”€ router/         # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ stores/         # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/            # APIæ¥å£
â”‚   â”‚   â””â”€â”€ App.vue
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â””â”€â”€ README.md
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.8+
- Node.js 16+
- Redis 6+

### 2. å®‰è£…åç«¯ä¾èµ–

```bash
cd backend
pip install -r requirements.txt
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `backend/.env` æ–‡ä»¶ï¼š

```env
DASHSCOPE_API_KEY=sk-7e1aeb711dec4355b53ecd8ff0116057
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
HOST=0.0.0.0
PORT=8000
```

### 4. å¯åŠ¨Redis

```bash
# Windows
redis-server

# Linux/Mac
sudo systemctl start redis
```

### 5. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend
python main.py
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:8000` å¯åŠ¨

### 6. å®‰è£…å‰ç«¯ä¾èµ–

```bash
cd frontend
npm install
```

### 7. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
npm run dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ `http://localhost:3000` å¯åŠ¨

## åŠŸèƒ½è¯´æ˜

### 1. ä¸–ç•Œè§‚å±•ç¤º
- æ¸¸æˆèƒŒæ™¯ä»‹ç»
- ä¸»æŒAIä»‹ç»
- å¿«é€Ÿå¯¼èˆª

### 2. è§’è‰²ç³»ç»Ÿ
- **å·²è§£é”è§’è‰²**ï¼šå¯ä»¥æŸ¥çœ‹æ¡£æ¡ˆã€å¼€å§‹å¯¹è¯
- **æœªè§£é”è§’è‰²**ï¼šæ˜¾ç¤ºè§£é”æ¡ä»¶ï¼Œé¼ æ ‡æ‚¬æµ®æŸ¥çœ‹æç¤º
- **è§’è‰²æ¡£æ¡ˆ**ï¼šæ€§æ ¼ã€èƒŒæ™¯ã€æŠ€èƒ½ç­‰ä¿¡æ¯

### 3. AIè§’è‰²å¯¹è¯
- æ¯ä¸ªè§’è‰²æœ‰ç‹¬ç«‹äººæ ¼
- åŸºäºå¯¹è¯å†å²çš„è®°å¿†ç³»ç»Ÿ
- æ”¯æŒè‡ªå®šä¹‰æ€§æ ¼ç‰¹å¾
- å®æ—¶WebSocketé€šä¿¡

### 4. å¤§äº‹ä»¶è§£è°œ
- æ¯ä¸ªè§’è‰²å¯¹åº”ä¸€ä¸ªè§£è°œäº‹ä»¶
- AIæ¨ç†å¼•æ“æä¾›çº¿ç´¢
- ç©å®¶è‡ªç”±æé—®å’Œæ¨ç†
- å¤šåˆ†æ”¯ç»“å±€

### 5. AIæ™ºèƒ½ç‹¼äººæ€
- å¤šäººåœ¨çº¿æˆ¿é—´
- AIä¸»æŒäººè‡ªåŠ¨æ¨è¿›æ¸¸æˆ
- å…¬å…±æ¶ˆæ¯+ç§æœ‰æ¶ˆæ¯åŒé€šé“
- æ”¯æŒ7-12äººæ¸¸æˆ
- è§’è‰²ï¼šç‹¼äººã€å¹³æ°‘ã€é¢„è¨€å®¶ã€å¥³å·«ã€çŒäºº

### 6. è§£é”æœºåˆ¶
- å®Œæˆæ–°æ‰‹å¼•å¯¼ â†’ è§£é”çŒ«ï¼ˆä¸§å½ªï¼‰
- èµ¢å¾—3åœºç‹¼äººæ€ â†’ è§£é”ç‹—ï¼ˆæ—ºè´¢ï¼‰
- å®Œæˆç¬¬ä¸€ä¸ªå¤§äº‹ä»¶ â†’ è§£é”é¸­å­ï¼ˆå˜å˜ï¼‰
- ä½œä¸ºå¹³æ°‘è·èƒœ â†’ è§£é”é³„é±¼ï¼ˆé³„éœ¸ï¼‰
- ä½œä¸ºç‹¼äººè·èƒœ â†’ è§£é”ç‹¼ï¼ˆç°å½±ï¼‰

### 7. çœŸå¿ƒè¯/å¤§å†’é™©ï¼ˆæ‰©å±•ï¼‰
- æ¸¸æˆç»“æŸåè‡ªåŠ¨ç”Ÿæˆ
- æ ¹æ®æ¸¸æˆç»“æœé€‰æ‹©é—®é¢˜ç±»å‹
- AIè‡ªåŠ¨ç”Ÿæˆä¸åŒéš¾åº¦çš„é—®é¢˜

## APIæ–‡æ¡£

å¯åŠ¨åç«¯æœåŠ¡åï¼Œè®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹Swagger APIæ–‡æ¡£ã€‚

### ä¸»è¦æ¥å£

- `GET /api/worldview` - è·å–ä¸–ç•Œè§‚
- `GET /api/characters` - è·å–æ‰€æœ‰è§’è‰²
- `GET /api/user/{user_id}/characters` - è·å–ç”¨æˆ·è§’è‰²åˆ—è¡¨
- `POST /api/user/{user_id}/characters/{character_id}/unlock` - è§£é”è§’è‰²
- `GET /api/user/{user_id}/events` - è·å–ç”¨æˆ·äº‹ä»¶åˆ—è¡¨
- `POST /api/werewolf/room` - åˆ›å»ºç‹¼äººæ€æˆ¿é—´
- `POST /api/werewolf/room/{room_id}/join` - åŠ å…¥æˆ¿é—´
- `POST /api/werewolf/room/{room_id}/start` - å¼€å§‹æ¸¸æˆ

### WebSocketç«¯ç‚¹

- `ws://localhost:8000/ws/character/{user_id}/{character_id}` - è§’è‰²å¯¹è¯
- `ws://localhost:8000/ws/event/{user_id}/{event_id}` - è§£è°œäº‹ä»¶
- `ws://localhost:8000/ws/werewolf/{room_id}/{user_id}` - ç‹¼äººæ€æ¸¸æˆ

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°è§’è‰²

1. åœ¨ `backend/data/characters.json` ä¸­æ·»åŠ è§’è‰²ä¿¡æ¯
2. åœ¨ `backend/data/events.json` ä¸­æ·»åŠ å¯¹åº”çš„å¤§äº‹ä»¶
3. å‰ç«¯ä¼šè‡ªåŠ¨åŠ è½½æ–°è§’è‰²

### è‡ªå®šä¹‰AI Prompt

ä¿®æ”¹ `backend/services/ai_service.py` ä¸­çš„promptæ„å»ºå‡½æ•°ã€‚

### æ‰©å±•æ¸¸æˆåŠŸèƒ½

æ‰€æœ‰æœåŠ¡éƒ½æ˜¯æ¨¡å—åŒ–çš„ï¼Œå¯ä»¥è½»æ¾æ‰©å±•ï¼š
- æ·»åŠ æ–°çš„æ¸¸æˆæ¨¡å¼
- æ‰©å±•è§’è‰²æŠ€èƒ½
- å¢åŠ æ–°çš„è§£è°œç±»å‹

## æ³¨æ„äº‹é¡¹

1. **Rediså¿…é¡»è¿è¡Œ**ï¼šå¤šäººæ¸¸æˆå’ŒçŠ¶æ€åŒæ­¥ä¾èµ–Redis
2. **API Keyé…ç½®**ï¼šç¡®ä¿DashScope API Keyæ­£ç¡®é…ç½®
3. **WebSocketè¿æ¥**ï¼šå‰ç«¯éœ€è¦æ­£ç¡®é…ç½®WebSocketä»£ç†
4. **ç”¨æˆ·ID**ï¼šå‰ç«¯ä½¿ç”¨localStorageå­˜å‚¨ç”¨æˆ·IDï¼Œæ¸…é™¤ç¼“å­˜ä¼šé‡ç½®è¿›åº¦

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤Issueã€‚


















